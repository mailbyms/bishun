<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汉字笔顺动画</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        .container {
            text-align: center;
            width: 100%;
            height: 100%;
            max-width: none;
        }
        .embed-container {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 100vh;
            background-color: white;
        }
        embed {
            max-width: 100%;
            max-height: 100%;
        }
      </style>
</head>
<body>
    <div class="container">
        <div class="embed-container">
            <div id="svgContainer" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
                <p style="color: #999; font-size: 14px;">等待输入汉字...</p>
            </div>
        </div>
    </div>

    <script>
        function showStrokeAnimation(character) {
            if (!character || character.trim() === '') {
                return;
            }

            // 获取第一个字符的 Unicode 码点
            const codePoint = character.charCodeAt(0);

            // 通过 Android 接口请求 SVG 内容
            if (window.AndroidInterface) {
                window.AndroidInterface.loadSvg(codePoint);
            }
        }

        function replayAnimation() {
            const container = document.getElementById('svgContainer');
            const svgElement = container.querySelector('svg');

            if (svgElement) {
                // 克隆 SVG 元素并替换，以重新启动动画
                const newSvg = svgElement.cloneNode(true);
                container.removeChild(svgElement);
                container.appendChild(newSvg);

                // 设置尺寸占满容器
                newSvg.setAttribute('width', '100%');
                newSvg.setAttribute('height', '100%');
                newSvg.style.width = '100%';
                newSvg.style.height = '100%';
            }
        }

        // 从 Base64 解码并更新 SVG 内容
        function updateSvgContentFromBase64(base64Svg) {
            console.log('updateSvgContentFromBase64 被调用，Base64 长度:', base64Svg ? base64Svg.length : 0);
            if (base64Svg && base64Svg.trim() !== '') {
                try {
                    console.log('开始 Base64 解码');
                    const svgContent = atob(base64Svg);
                    console.log('Base64 解码成功，SVG 长度:', svgContent.length);
                    updateSvgContent(svgContent);
                } catch (e) {
                    console.error('Base64 解码失败:', e);
                }
            } else {
                console.error('Base64 SVG 内容为空');
            }
        }

        // 更新 SVG 内容
        function updateSvgContent(svgContent) {
            console.log('updateSvgContent 被调用，SVG 长度:', svgContent ? svgContent.length : 0);
            if (svgContent && svgContent.trim() !== '') {
                try {
                    // 直接在容器中插入 SVG 内容
                    const container = document.getElementById('svgContainer');
                    console.log('找到容器:', container);

                    // 清空容器并插入 SVG
                    container.innerHTML = svgContent;
                    console.log('SVG 内容已插入到容器');

                    // 设置 SVG 的尺寸占满容器
                    const svgElement = container.querySelector('svg');
                    console.log('找到 SVG 元素:', svgElement);
                    if (svgElement) {
                        svgElement.setAttribute('width', '100%');
                        svgElement.setAttribute('height', '100%');
                        svgElement.style.width = '100%';
                        svgElement.style.height = '100%';
                        console.log('SVG 尺寸设置完成');
                    } else {
                        console.error('未找到 SVG 元素');
                    }

                    console.log('SVG 加载完成');
                } catch (e) {
                    console.error('SVG 更新失败:', e);
                }
            } else {
                console.error('SVG 内容为空');
            }
        }

        // 暴露函数给 Android 调用
        window.showStrokeAnimation = showStrokeAnimation;
        window.replayAnimation = replayAnimation;
        window.updateSvgContent = updateSvgContent;

            </script>
</body>
</html>